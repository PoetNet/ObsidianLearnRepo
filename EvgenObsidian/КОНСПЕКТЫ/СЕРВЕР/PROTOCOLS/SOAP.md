IBM: [SOAP - IBM Documentation](https://www.ibm.com/docs/ru/rsas/7.5.0?topic=standards-soap)

---

`SOAP` (Simple Object Access Protocol) - это упрощенный протокол обмена информацией в распределенной среде без централизованного управления. Для передачи информации между отправителем и получателем применяются `сообщения SOAP`. Путем объединения нескольких `сообщений SOAP` можно создавать `шаблоны запрос-ответ`. Несмотря на отсутствие зависимости от конкретного транспортного протокола, в большинстве случаев протокол `SOAP` используется совместно с протоколом [[HTTP|HTTP]] для обеспечения поддержки существующей инфраструктуры сети Internet. 

>`SOAP` - это протокол на основе `XML`, описывающий три части каждого сообщения:

- `Пакет`.  Пакет задает среду для описания содержимого сообщения и способа его обработки. Сообщение `SOAP` представляет собой пакет, содержащий произвольное число заголовков и одно тело. Пакет является элементом верхнего уровня документа `XML` и выполняет роль контейнера, содержащего информацию об управлении, адрес сообщения и текст сообщения. В заголовках передается информация об управлении. Тело содержит идентификационные данные сообщения и его параметры. Заголовки и тело являются дочерними элементами пакета.
  
- `Правила кодировки`.  Набор правил кодировки описывает экземпляры типов данных приложения. Правила кодировки задают механизм сериализации для обмена экземплярами типов данных приложения. `SOAP` задает независимую от языка программирования схему типов данных на основе `XSD`, а также набор правил кодировки для всех типов данных. 

- `Стили взаимодействия`. Операции взаимодействия можно реализовать в формате вызова [[RPC, gRPC|удаленных процедур (RPC)]] или обмена сообщениями (документами). Ниже приведено описание этих стилей взаимодействия.

### Стили связывания

`SOAP` поддерживает два стиля взаимодействия:

-  [[RPC, gRPC|RPC]]:  Вызов операции с возвратом результата. Как правило, используется совместно с кодировкой `SOAP`.

- `Обмен документами`:  Этот стиль предусматривает обмен документами или сообщениями; он описывает слой абстракций более низкого уровня.

### Стили кодировки

>В распределенных вычислительных системах стили кодировки описывают способ преобразования данных между внутренним форматом приложения и форматом конкретного протокола. Процесс преобразования называется `сериализацией` и `десериализацией`.

Спецификация `SOAP` задает стиль `кодировки SOAP`:

-  Кодировка `SOAP`:  Стиль `кодировки SOAP` обеспечивает сериализацию/десериализацию значений типов данных из модели данных `SOAP`. Данный стиль кодировки описан в стандарте SOAP 1.1.

`WSDL` описывает литеральный тип кодировки:

- Литеральный тип:  Термин литеральный указывает, что документ считывается в исходном виде, т.е. без кодировки. Сериализация документа выполняется в виде XMI (исходный код XML сообщения компилируется в соответствии со схемой из WSDL). В случае применения литерального типа каждый фрагмент сообщения связан с конкретным определением схемы. Литеральный тип совместим с WS-I.

### Модель данных

Модель данных `SOAP` призвана предоставить независимые от языка абстрактные типы данных, применяемые общими типами языков программирования. Она состоит из следующих типов:

- Простые типы `XSD`. Например, `int`, `string` и `date`.
- Составные типы. Составные типы разделяются на две категории: структуры и массивы. `Структуры` - это именованные составные типы, каждому элементу которых присваивается уникальное имя (тег `XML`). `Массивы` содержат элементы, роль идентификаторов которых выполняет их положение, а не имя.

Все элементы и идентификаторы, входящие в состав модели данных `SOAP`, определены в `URI` пространства имен. Стандарт `SOAP` описывает правила создания типов данных. Схема `XML` проекта должна задавать фактические типы данных. 

### Реализации SOAP

Теперь доступны различные реализации протокола `SOAP`. Например, `Apache Foundation` предоставляет `Apache SOAP`, разработанный на основе проекта `IBM SOAP4J`, а также среды выполнения `Apache Axis` и `IBM WebSphere`.

### Связи

`Связь` задает связывание между полным именем элемента `XML`, именем `класса C#/Java` и стилем кодировки. Связь описывает способ прямого и обратного преобразования между входящим элементом `XML` с полным именем и `классом C#/Java` в пределах конкретной кодировки.

## Отличия SOAP от REST

На верхнем уровне `SOAP` ограничивает структуры сообщений, тогда как REST — это архитектурный подход, ориентированный на использование HTTP в качестве транспортного протокола.

Специфика `SOAP` — это формат обмена данными. 
С `SOAP` это всегда `SOAP-XML`, который представляет собой `XML`, включающий:  
 
- `Envelope` (конверт) – корневой элемент, который определяет сообщение и пространство имен, использованное в документе,  
-  `Header` (заголовок) – содержит атрибуты сообщения, например: информация о безопасности или о сетевой маршрутизации,  
-  `Body` (тело) – содержит сообщение, которым обмениваются приложения,  
- `Fault` – необязательный элемент, который предоставляет информацию об ошибках, которые произошли при обработке сообщений. И запрос, и ответ должны соответствовать структуре `SOAP`.

#### Формат обмена сообщениями

- В `SOAP` вы используете формат `SOAP XML` для запросов и ответов.
- В [[REST|REST]] такого фиксированного формата нет. Вы можете обмениваться сообщениями на основе `XML`, `JSON` или любого другого удобного формата. `JSON` является самым популярным среди используемых форматов.

#### Определения услуг
  
- `SOAP` использует `WSDL` (Web Services Description Language) — язык описания веб-сервисов и доступа к ним, основанный на языке `XML`.
- [[REST|REST]] не имеет стандартного языка определения сервиса. Несмотря на то, что `WADL` был одним из первых предложенных стандартов, он не очень популярен. Более популярно использование `Swagger` или `Open API`.

#### Транспорт

`SOAP` не накладывает никаких ограничений на тип транспортного протокола. Вы можете использовать либо протокол [[HTTP|HTTP]] либо `MQ`.  
  
#### Простота реализации

`RESTFful сервисы`, как правило, гораздо проще реализовать, чем веб-сервисы на основе `SOAP`.  

- [[REST|REST]] обычно использует `JSON`, который легче анализировать и обрабатывать. В дополнение к этому, [[REST|REST]] не требует наличия определения службы для предоставления веб-службы.
- Однако в случае `SOAP` вам необходимо определить свой сервис с использованием WSDL, и при обработке и анализе сообщений `SOAP-XML` возникают большие накладные расходы.